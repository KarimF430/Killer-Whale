## 2025-05-22 - [Critical] Unprotected Administrative and PII Endpoints
**Vulnerability:** Several administrative and system-sensitive endpoints (e.g., `/api/admin/users`, `/api/cache`, `/api/diagnostics`, `/api/admin/backup`, `/api/variants`) were completely unprotected by authentication and authorization middleware. The `/api/admin/users/export` endpoint allowed unauthorized downloading of all frontend users' PII (emails, phone numbers, etc.) in CSV format.
**Learning:** The application utilizes multiple authentication systems (`backend/server/auth.ts` vs `backend/server/middleware/auth.ts` vs session-based), which likely led to developer confusion and inconsistent application of security middleware across different route files and entry points.
**Prevention:** Consolidate administrative routes under a single authentication/authorization strategy and ensure that all sensitive routes are audited for middleware application during registration, particularly those mounted in the main server entry point (`index.ts`).
